# 주문 API 명세서

## 1. 개요
- 사용자가 상품을 주문하는 API입니다.
- 주문 시 상품, 수량 등의 정보를 받아 주문을 생성하고, 해당 주문에 대한 상태를 관리합니다.

---

## 2. API 정보

| 항목         | 내용                                                      |
|--------------|-----------------------------------------------------------|
| API 명칭     | 주문 API                                                   |
| 설명         | 사용자가 장바구니 또는 상품 상세보기에서 선택한 상품을 주문하는 기능입니다. |
| 관련 도메인  | Order, OrderItem, Product, User, Coupon                    |

---

## 3. 요청

- Method: `POST`
- Endpoint: `/orders/{userId}/create`

#### 요청 파라미터

| 변수명    | 타입    | 필수   | 설명                                    |
|----------|---------|--------|-----------------------------------------|
| userId   | Long    | ✅     | 주문을 진행할 사용자 ID                |

#### Request Body
```
{
"cartItems": [
{
"productId": 1,
"quantity": 2
},
{
"productId": 2,
"quantity": 1
}
],
"couponId": 12345   // 사용자가 쿠폰을 사용할 경우
}
```
| 필드명     | 타입   | 필수  | 설명                                        |
|------------|--------|-------|--------------------------------------------|
| cartItems  | Array  | ✅    | 주문하려는 상품 목록 (상품ID, 수량)       |
| couponId   | Long   | ❌    | 사용할 쿠폰 ID (옵션, 사용 시 제공)         |

---

## 4. 응답

#### 4.1 성공 시
```
{
"message": "주문이 성공적으로 생성되었습니다.",
"orderId": 12345,
"totalAmount": 15000
}
```
| 필드명         | 타입   | 설명                                          |
|----------------|--------|-----------------------------------------------|
| message        | String | 처리 결과 메시지                               |
| orderId        | Long   | 생성된 주문의 고유 ID                         |
| totalAmount    | Int    | 주문한 상품들의 총 금액                       |

#### 4.2 상태 코드

| 코드 | 설명                      |
|------|---------------------------|
| 200  | 주문 성공                  |
| 400  | 잘못된 요청               |
| 404  | 사용자 없음               |
| 409  | 재고 부족                  |

---

## 5. 예외 처리

| 예외 상황                | HTTP 상태 | 설명                                                                 |
|-------------------------|------------|----------------------------------------------------------------------|
| 재고 부족                | 409        | 주문하려는 상품의 재고가 부족한 경우                                 |
| 잘못된 요청             | 400        | 요청한 데이터가 누락되었거나 잘못된 경우                             |
| 존재하지 않는 상품 ID   | 404        | 주문하려는 상품이 데이터베이스에 없는 경우                           |

---

## 6. 테스트 포인트

| 테스트 항목             | 검증 내용                                                       |
|------------------------|------------------------------------------------------------------|
| 사용자 ID 식별 처리      | 요청에 포함된 userId가 정확히 식별되어 처리되는가                |
| 주문 가능 상품 확인      | 주문하려는 상품이 실제로 존재하고, 재고가 충분한가               |
| 정상 주문 처리           | 유효한 주문이 생성되고, 해당 주문의 ID가 반환되는가              |
| 재고 부족 처리            | 재고가 부족한 경우, 주문이 거절되고 적절한 오류 메시지가 반환되는가 |
| 쿠폰 사용 처리            | 유효한 쿠폰이 적용되었을 때, 할인 금액이 올바르게 적용되는가      |

[돌아가기](../../README.md)