# API 명세 - 잔액 충전 API

### 1. 개요

사용자가 금액을 충전하여 결제에 사용할 수 있도록 하는 API입니다.  
사용자 식별자와 충전할 금액을 받아 잔액을 충전합니다.

---

### 2. API 정보

| 항목        | 내용                                             |
|-------------|------------------------------------------------|
| API 명칭     | 잔액 충전 API                                      |
| 설명         | 사용자 ID를 기반으로 금액을 충전하여, 이후 결제에 사용할 수 있도록 처리합니다. |
| 관련 도메인  | User, Point, PointHistory                      |

---

### 3. 요청

- Method: `POST`
- Endpoint: `/point/{userId}/charge`

#### 3.1 Path Variable

| 변수명 | 타입 | 필수 | 설명                                 |
|--------|------|------|----------------------------------------|
| userId | Long | ✅   | 충전 대상 사용자 ID (고유 사용자 식별자) |

#### 3.2 Request Body
```
{
"amount": 5000
}
```
| 필드명 | 타입 | 필수 | 설명                                            |
|--------|------|------|-----------------------------------------------|
| amount | Int  | ✅   | 충전할 금액 (양수, 1회 최대 금액 제한 가능 – 예: 10,000,000원) |

---

### 4. 응답

#### 4.1 성공 시
```
{
"point": 15000,
"message": "충전이 완료되었습니다."
}
```
| 필드명     | 타입   | 설명                     |
|---------|--------|--------------------------|
| point   | Int    | 충전 후 사용자 보유 잔액 |
| message | String | 처리 결과 메시지         |

#### 4.2 상태 코드

| 코드 | 설명           |
|------|----------------|
| 200  | 충전 성공       |
| 400  | 잘못된 요청     |
| 404  | 사용자 없음     |
| 409  | 최대 잔액 초과  |

---

### 5. 예외 처리

| 예외 상황                | HTTP 상태 | 설명                                              |
|-------------------------|------------|-------------------------------------------------|
| 사용자 ID 누락 또는 오류 | 400        | URI 경로에 userId가 없거나 유효하지 않은 경우                  |
| 사용자 없음             | 404        | 존재하지 않는 사용자 ID로 요청한 경우                          |
| 금액이 0 이하            | 400        | amount가 0 또는 음수인 경우                             |
| 1회 충전 최대 금액 초과 | 400        | 시스템이 허용하는 1회 충전 최대 금액을 초과한 경우 *(예: 10,000,000원)* |
| 총 잔액 최대 한도 초과   | 409        | 충전 후 잔액이 시스템 한도 *(예: 1,000,000원)* 를 초과하는 경우     |
| 형식 오류               | 400        | JSON body가 잘못되었거나 필드 누락                         |

---

### 6. 테스트 포인트

| 테스트 항목             | 검증 내용                              |
|------------------------|------------------------------------|
| 사용자 ID 식별 처리      | 요청에 포함된 userId가 정확히 식별되어 처리되는가     |
| 사용자 없음 처리         | 존재하지 않는 사용자 ID로 요청 시 404 응답이 반환되는가 |
| 정상 충전 처리           | 유효한 금액 입력 시 잔액이 누적 반영되는가           |
| 1회 최대 금액 초과       | 1회 최대 충전 금액 초과 시 예외가 발생하는가         |
| 최대 잔액 초과 처리       | 충전 후 잔액이 시스템 최대 한도 초과 시 예외가 발생하는가  |
| 음수 또는 0 입력 처리     | 유효하지 않은 요청으로 예외가 발생하는가             |
| 충전 기록 저장 확인       | PointHistory 테이블에 충전 내역이 정확히 기록되는가 |

[돌아가기](../../README.md)